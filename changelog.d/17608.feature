hash_password now accepts input from stdin