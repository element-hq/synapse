Fix open redirect in legacy SSO flow with the `idp` query parameter.
